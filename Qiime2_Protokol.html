<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Qiime2_Protokol.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Font Awesome -->
<!-- <link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" /> -->
<!-- <script src="https://use.fontawesome.com/54ee8c2dfd.js"></script> -->

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,700italic|Oswald:400,700' rel='stylesheet' type='text/css'>

<!-- Favicon -->
<link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">

<!-- Google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-8298649-8', 'auto');
  ga('send', 'pageview');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bionesia2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="setup.html">
    <span class="fas fa-cog"></span>
     
    Setup
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fas fa-download"></span>
     
    Data
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">--- Core Lessons ---</li>
    <li>
      <a href="r-basics.html">R Basics</a>
    </li>
    <li>
      <a href="r-dataframes.html">Data Frames</a>
    </li>
    <li>
      <a href="r-dplyr-yeast.html">Data Manipulation</a>
    </li>
    <li>
      <a href="r-tidy.html">Tidying data</a>
    </li>
    <li>
      <a href="r-rmarkdown.html">Reproducible Research &amp; RMarkdown</a>
    </li>
    <li>
      <a href="r-viz-gapminder.html">Data Visualization</a>
    </li>
    <li>
      <a href="r-ggtree.html">Phylogenetic Trees</a>
    </li>
    <li>
      <a href="r-rnaseq-airway.html">RNA-seq</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">--- Optional Lessons ---</li>
    <li>
      <a href="r-stats.html">Essential Statistics with R</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">--- Homework ---</li>
    <li>
      <a href="r-dplyr-homework.html">Data Manipulation</a>
    </li>
    <li>
      <a href="r-dataviz-homework.html">Data Visualization</a>
    </li>
    <li>
      <a href="r-rmarkdown-homework.html">Reproducible Research &amp; RMarkdown</a>
    </li>
    <li>
      <a href="r-stats-homework.html">Essential Statistics</a>
    </li>
    <li>
      <a href="r-rnaseq-homework.html">RNA-seq Data Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Courses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">--- Basic Course ---</li>
    <li>
      <a href="r-basics.html">R Basics</a>
    </li>
    <li>
      <a href="r-dataframes.html">Data Frames</a>
    </li>
    <li>
      <a href="r-dplyr-yeast.html">Data Manipulation</a>
    </li>
    <li>
      <a href="r-tidy.html">Tidying data</a>
    </li>
    <li>
      <a href="r-rmarkdown.html">Reproducible Research &amp; RMarkdown</a>
    </li>
    <li>
      <a href="r-viz-gapminder.html">Data Visualization</a>
    </li>
    <li>
      <a href="r-ggtree.html">Phylogenetic Trees</a>
    </li>
    <li>
      <a href="r-rnaseq-airway.html">RNA-seq</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">--- Intermediate Course ---</li>
    <li>
      <a href="r-basics.html">R Basics</a>
    </li>
    <li class="dropdown-header">--- Advance Course ---</li>
    <li>
      <a href="Qiime2_Protokol.html">Get to know Qiime2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-question fa-lg"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="index.html#faq">FAQ</a>
    </li>
    <li>
      <a href="help.html">Further resources</a>
    </li>
    <li>
      <a href="https://github.com/metabarcodingcourse/2020Course">Source code for this site</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="qiime2-tutorial" class="section level2">
<h2>QIIME2 Tutorial</h2>
<p>Analisis bioinformatic merupakan tantangan baru dalam penelitian yang berbasiskan <em>Next Generation Sequencing (NGS)</em>. Pengolahan data sekuen DNA dalam jumlah besar memerlukan sarana dan prasarana yang memadai. Misalnya, dibutuhkan komputer dengan <em>memory</em> yang cukup besar untuk menyimpan data mentah, melakukan pengolahan data, menyimpan data yang sedang diolah dan meyimpan hasil akhir dari analisis.</p>
<p>Tutorial kecil ini akan memperkenalkan langkah-langkah pengolahan data dari metode <em>NGS-DNA Metabarcoding</em>, dengan menggunakan pipeline QIIME2 (<em>the Quantitative Insights Into Microbial Ecology 2 program</em>, <a href="https://qiime2.org/" class="uri">https://qiime2.org/</a>) (Bolyen et al., 2018). Selanjutnya, ada banyak pipeline lain serta cara untuk melakukan <em>trouble shooting</em> yang tersedia di internet dan dapat di-akses secara bebas. Harapannya, dengan tutorial ini, kita dapat melakukan analisis secara langsung dengan data yang sederhana, sehingga para peneliti memiliki gambaran tentang apa itu analisis bioinformatika untuk kebutuhan penelitian berbasis NGS.</p>
<p>Sebelum melakukan analisis bioinformatika, ada beberapa hal yang harus diperhatikan atau menjadi catatan:</p>
<div id="primer" class="section level3">
<h3>1. Primer</h3>
<p>Primer atau <em>DNA marker</em> yang dipilih tentunya telah disesuaikan dengan pertanyaan riset. Primer akan menentukan pemilihan database pada proses <em>taxonomy assignment</em>, dan <em>threshold</em> atau batas persentase kesamaan yang digunakan dalam metode <em>clustering</em>. Pada umumnya untuk pada mikrobia dengan menggunakan marker 16S rRNA, <em>threshold</em> yang digunakan adalah 97% <em>identity</em> untuk dapat membedakan bakteria pada level genus. 97% <em>threshold</em> juga digunakan pada marker COI (<em>Cytochrome Oxidase subunit 1</em>). Latar belakang penggunakan 97% <em>threshold</em> adalah bahwa rata-rata, minimum dissimilarity antara spesies berdasarkan marker yang umum dipakai pada primer metabarcoding (misal: COI, 16S) adalah sekitar 3% (Hebert, Ratnasingham, Waard, B, &amp; Jeremy, 2003). Sedangkan untuk 18S rRNA, <em>threshold</em> yang umumnya digunakan adalah 99%.</p>
<p>Contoh kombinasi primer COI dengan Nextera-tail (Illumina primer) berdasarkan (Leray et al., 2013) yang telah digunakan untuk analisis metabarcoding pada invertebrata:</p>
<p>Ukuran produk sekuen: kurang lebih 380 bp (313 bp COI + 67 bp tails)</p>
<ul>
<li><strong>Forward</strong>: i5 (F) NexTail mlCOIintF
<ul>
<li>TCGTCGGCAGCGTCAGATGTGTATAAGAGACAG GGWACWGGWTGAACWGTWTAYCCYCC</li>
</ul></li>
<li><strong>Reverse</strong>: i7 (R) NexTail jgCOIR_
<ul>
<li>GTCTCGTGGGCTCGGAGATGTGTATAAGAGACAG TAIACYTCIGGRTGICCRAARAAYCA</li>
</ul></li>
</ul>
</div>
<div id="paired-atau-single-end" class="section level3">
<h3>2. Paired atau Single end</h3>
<p>Ini berhubungan dengan metode yang digunakan dalam mengamplifikasi sequence DNA pada proses PCR (<em>Polymerase Chain Reaction</em>). Sequence umumnya diamplifikasi dari dua arah atau memakai sepasang primer (<em>paired-end</em>). Akan tetapi, sekuen juga dapat diamplifikasi hanya dari satu arah dan memakai 1 primer (<em>single end</em>).</p>
</div>
<div id="protokol-laboratorium" class="section level3">
<h3>3. Protokol laboratorium</h3>
<p>Protokol atau langkah-langkah yang dilakukan saat mempersiapkan sekuen (<em>library preparation</em>) sangat mempengaruhi langkah-langkah dalam melakukan analisis bioinformatika. Beberapa laboratorium memiliki pendekatan yang berbeda-beda dalam menyiapkan library. Salah satu contohnya adalah sistem <em>dual indexing</em>, dimana PCR dilakukan dua kali. PCR pertama memakai primer universal, seperti yang disebutkan di atas, lengkap dengan <em>Nextera barcode</em>-nya. Kemudian proses selanjutnya adalah menggabungkan beberapa sample menjadi satu (<em>multiplex</em>) dengan memberikan barcode yang unik pada tiap sample yang digabungkan.</p>
<p>Dari protocol ini, yang harus diperhatikan adalah pencatatan identitas sample atau <em>sample_ID</em> yang konsisten, lengkap dengan barcode yang dipasangkan pada <em>sample_ID</em> tersebut, sehingga tidak terjadi kerancuan ketika sample di-unduh dari mesin sekuensing.</p>
</div>
<div id="mesin-sekuensing-dan-jenis-data" class="section level3">
<h3>4. Mesin sekuensing dan Jenis Data</h3>
<p>Mesin sekuensing yang digunakan dalam riset NGS memiliki spesifikasi berbeda-beda. Mulai dari kemampuan menganalisis data, besar data yang ampu dianalisis, hingga reagen spesifik yang harus digunakan. Saat ini, umumnya NGS memakai <em>Illumina platform</em> yang memiliki reagen dan protocol yang cukup umum.</p>
<p>Berhubungan dengan analisis bioinformatika, pengetahuan tentang mesin sekuensing yang digunakan akan membantu kita menentukan parameter yang dipakai dalam proses analisis, misalnya berapa rata-rata error yang dihasilkan sebuah mesin.</p>
<p>Hal lain yang perlu diketahui adalah bagaimana sebuah mesin sekuensing memproduksi data atau sekuen. Apakah sekuen masih dalam gabungan beberapa sekuen dengan barcoding berbeda? Apakah sekuen yang dihasilkan sudah di-<em>demultiplexed</em>? Atau apakah barcode dari primer sudah dihapus oleh mesin. Pengetahuan ini akan memudahkan kita dalam mempersiapkan langkah-langkah analisis bioinformatika.</p>
</div>
</div>
<div id="qiime2-pipeline" class="section level2">
<h2>QIIME2 Pipeline</h2>
<p>Qiime2 merupakan sebuah pipeline bioinformatika yang terintegrasi dan dibuat untuk menganalisa microbiome data. Data yang dihasilkan oleh Qiime2 disebut sebagai QIIME 2 <em>artifacts</em> (.qza) dan <em>visualization</em> file (.qzv).</p>
<ul>
<li><em>Qiime2 artifacts</em> berisi data dan metadata yang menjelaskan data bersangkutan, seperti tipe data, format data dan bagaimana data dibuat.</li>
<li><em>Visualization</em> data adalah data yang dihasilkan untuk dapat divisualisasi melalui <em>Qiime2 view interaface</em> (<a href="https://view.qiime2.org/" class="uri">https://view.qiime2.org/</a>).</li>
</ul>
<p><strong>Install qiime2</strong>: <a href="https://docs.qiime2.org/2020.2/install/" class="uri">https://docs.qiime2.org/2020.2/install/</a> <strong>Catatan:</strong> cara meng-install Qiime2 pada windows dapat dilihat pada akhir tutorial ini.</p>
</div>
<div id="langkah-analisis" class="section level2">
<h2>Langkah Analisis</h2>
<div id="demultiplexing" class="section level3">
<h3>1. Demultiplexing</h3>
<p>Jika data mentah masih dalam bentuk gabungan beberapa sample atau <em>multiplexed</em>, maka kita perlu melakukan <em>demultiplexing</em> atau pemisahan data atau sampel menjadi individual sample. Pada proses ini yang diperlukan adalah <em>list barcode</em> yang digunakan sesuai dengan <em>sample_ID</em>.</p>
<p>Jika data mentah sudah dipisahkan kedalam individual sample, yang perlu diperhatikan adalah apakah data tersebut merupakan data dua arah (<em>paired-end</em>) atau satu arah (<em>single end</em>). Disini yang diperlukan adalah <em>manifest file</em> (.txt file) yang berfungsi mengidentifikasi sekuen yang unik.</p>
<p>Untuk lebih jelas, silakan masuk ke: <a href="https://docs.qiime2.org/2020.2/tutorials/moving-pictures/" class="uri">https://docs.qiime2.org/2020.2/tutorials/moving-pictures/</a></p>
<p>Disini kita akan memakai contoh, 2 sampel yang dianalisis dari dua arah (<em>paired-end</em>).</p>
<p><strong>Contoh</strong> nama file data mentah yang dihasilkan oleh mesin Illumina sekuensing:</p>
<ul>
<li>60A_S1_L001_R1_001.fastq.gz</li>
<li>60A_S1_L001_R2_001.fastq.gz</li>
<li>206_S2_L001_R1_001.fastq.gz</li>
<li>206_S2_L001_R2_001.fastq.gz</li>
<li><strong>Catatan</strong>:
<ul>
<li>60A dan 206 adalah sample_ID</li>
<li>S1 dan S2 adalah kode yang dihasilkan mesin untuk menyatakan ini sample keberapa yang dianalisis mesin</li>
<li>R1 dan R2 adalah penanda arah amplifikasi (<em>forward</em> dan <em>reverse</em>)</li>
<li>Kita akan membuat folder “qiime2_workshop” dan didalamnya kita akan membuat folder “Workshop_data” untuk menyimpan semua sekuen.</li>
<li>Disini kita juga bisa melakukan cek secara manual dan random, apakah sekuen masih berisi primers atau tidak.</li>
</ul></li>
</ul>
<p><strong>Fastq file</strong>:</p>
<p>Fastq memiliki 4 baris, yang terdiri dari label atau <em>sequence identifier</em> di baris pertama; urutan sekuen di baris kedua; tanda + pada baris ketiga berfungsi sebagai separator; dan kualitas dari sekuen (<em>Phred scores</em> atau <em>Q scores</em>) di baris ke empat. <em>Q scores</em> disesuaikan dengan <strong>ASCII standard</strong> (<em>American Standard Code for Information Interchange</em>). <a href="https://www.drive5.com/usearch/manual/quality_score.html" class="uri">https://www.drive5.com/usearch/manual/quality_score.html</a></p>
<p><img src="img/Slide1.png" /></p>
<p><strong>Contoh manifest file</strong></p>
<p><img src="img/Slide2.png" /></p>
<p><strong>Catatan:</strong></p>
<ul>
<li>Kita akan mengubah sample_ID 60A menjadi ASEU1A100 dan 206 menjadi ASEU1A500</li>
<li>PWD (<em>print working directory</em>) untuk menuliskan <em>directory</em> dimana kita bekerja saat ini</li>
</ul>
<p>Dari sini kita akan menggabungkan data menjadi <em>Qiime2 artifacts</em> file untuk bisa masuk ke tahap selanjutnya. Pada proses ini kita akan bekerja pada folder “qiime2_workshop” yang telah dipersiapkan. Pada proses ini, sample akan di <em>paired-end</em> dan kita bisa mengecek kualitas sekuen dari <em>visualization file</em>.</p>
<p>Data awal informasi yang perlu dimasukkan ke dalam folder kerja (folder “qiime2_workshop”) adalah manifest file (manifest_workshop.txt) dan informasi meta-data dari sampel tersebut (map_workshop.txt).</p>
<p>Kita akan mulai dengan <strong>cd</strong> command yang akan membawa kita ke folder atau <em>directory</em> tempat kita bekerja. Pastikan juga jika Qiime2 sudah diaktifkan (misal dengan mengetik <code>$ conda activate qiime2-2020.2</code>).</p>
<pre><code>qiime tools import \ 
  --type &#39;SampleData[PairedEndSequencesWithQuality]&#39; \
  --input-path manifest_workshop.txt \
  --output-path paired-end-workshop.qza \
  --input-format PairedEndFastqManifestPhred33</code></pre>
<p>kita bisa melihat arti setiap maksud dan tujuan command atau perintah kita terhadap qiime2 tersebut dengan menambahkan kata <code>--help</code> di akhir judul command perintah</p>
<p><strong>Contoh:</strong> <code>qiime tools import --help</code></p>
<p>Maka kita bisa mengetahui maksud arti dari perintah-perintah yang dibuat seperti <code>–-type</code>, <code>--input-path</code>, <code>--output-path</code>, <code>--input-format</code>. kita bisa melakukan <code>--help</code> tersebut kesemua judul perintah command kita</p>
<pre><code>qiime demux summarize \
  --i-data paired-end-workshop.qza \ 
  --o-visualization paired-end-workshop.qzv</code></pre>
<p>kita bisa melihat hasil visualisasi dari setiap format data .qzv melalui <a href="https://view.qiime2.org/" class="uri">https://view.qiime2.org/</a>, drag file tersebut kedalam web browser tersebut.</p>
</div>
<div id="quality-control" class="section level3">
<h3>2. Quality control</h3>
<p>DADA2 (Callahan et al., 2016) merupakan sebuah pipeline yang dipakai untuk melakukan deteksi dan koreksi terhadap sekuen amplicon yang dihasilkan oleh Illumina platform. Pada proses ini akan dilakukan <em>quality control</em> yang akan mem-filter phiX reads serta mem-filter chimera. PhiX merupakan <em>single-stranded</em> DNA (ssDNA) virus yang digunakan secara komersial dalam proses sekuensing sebagai control positif.</p>
<p>Jika kita ingin potong primer sebelum proses DADA2, kita bisa memakai “cutadapt” (Martin, 2011). Kemudian di DADA2, kita beri <code>p-trim-left-f</code> dan <code>p-trim-left-r</code> nilai 0.</p>
<pre><code>qiime cutadapt trim-paired \
  --i-demultiplexed-sequences paired-end-workshop.qza \
  --p-cores 8 \
  --p-front-f GGGWACWGGWTGAACWGTWTAYC \
  --p-front-r TAAACTTCAGGGTGACCAAARAA \
  --o-trimmed-sequences demux-trimmed-workshop.qza</code></pre>
<pre><code>qiime demux summarize \
  --i-data demux-trimmed-workshop.qza \
  --o-visualization demux-trimmed-workshop.qzv</code></pre>
<p>Jika tidak, kita dapat langsung masuk ke DADA2 dan memberikan parameter panjang primer <em>forward</em> dan <em>reverse</em> yang akan dipotong. Parameter <code>trunc-len-f</code> dan <code>trunc-len-r</code> merupakan parameter “panjang sekuen” yang akan digunakan dan dipilih karena memiliki kualitas yang baik. Panjang sekuen yang akan dipotong ditentukan oleh visualization data pada analisis sebelumnya (“paired-end-workshop.qzv” atau “demux-trimmed-workshop.qv”).</p>
<p><img src="img/Slide3.png" /></p>
<p>Guna visualisasi data, pada proses ini kita akan membutuhkan metadata atau map.txt yang berisi keterangan tentang sample kita. Terlampir contoh dari map.txt.</p>
<pre><code>qiime dada2 denoise-paired \
  --i-demultiplexed-seqs demux-trimmed-workshop.qza \
    --p-trim-left-f 0 \
    --p-trim-left-r 0 \
    --p-trunc-len-f 200 \
    --p-trunc-len-r 160 \
    --o-table table-dada2.qza \
    --o-representative-sequences rep-seqs-dada2.qza \
    --o-denoising-stats denoising-stats-dada2.qza \
    --p-n-threads 24</code></pre>
<p><strong>Catatan</strong>: DADA2 memakan waktu running yang agak lama; Pada protokol ini, kita lewati langkah ini dan gunakan data yang sudah disiapkan</p>
<pre><code>qiime metadata tabulate \
  --m-input-file denoising-stats-dada2.qza \
  --o-visualization denoising-stats-dada2.qzv

qiime feature-table tabulate-seqs \
  --i-data rep-seqs-dada2.qza \
  --o-visualization rep-seqs-dada2.qzv

qiime feature-table summarize \
  --i-table table-dada2.qza \
  --m-sample-metadata-file map_workshop.txt \
  --o-visualization table-dada2.qzv</code></pre>
<p>Visualisasi yang dihasikan:</p>
<ul>
<li>denoising-stats-dada2.qzv; rep-seqs-dada2.qzv; table-dada2.qzv.</li>
<li>Beberapa istilah dalam table-dada2.qzv:
<ul>
<li><strong>Feature</strong> adalah jumlah sekuence unik yang juga berkorelasi dengan jumlah taxa setelah melakukan <em>taxonomy assignment</em>.</li>
<li><strong>Frequency</strong> adalah jumlah sekuen total atau sequence <strong>reads</strong></li>
</ul></li>
</ul>
</div>
<div id="clustering" class="section level3">
<h3>3. Clustering</h3>
<p>Proses clustering merupakan proses pengelompokan sekuen berdasarkan persentase kesamaannya. Proses ini akan menghasilkan <em>Operational Taxonomic Unit (OTU)</em>. Proses clustering dapat dilakukan dengan tiga pendekatan; <em>de novo, close reference dan open refence</em>.</p>
<ul>
<li><strong>De novo</strong>: pada proses ini sekuen atau reads diagabungkan antara satu dengan lainnya tanpa ada sekuen pembanding atau <em>reference sequence</em>.</li>
<li><strong>Close reference</strong>: sekuen dikelompokkan bedasarkan sekuen pembanding dan sekuen yang tidak memiliki pembanding, tidak akan digunakan dalam analisis.</li>
<li><strong>Open reference</strong>: sekuen dikelompokkan berdasarkan sekuen pembanding, dan sekuen yang tidak memiliki pembanding akan dikelompokkan secara <em>de novo</em>.</li>
</ul>
<p>Pada contoh ini, kita akan menggunakan Vsearch pipeline (Rognes, Flouri, Nichols, Quince, &amp; Mahé, 2016) untuk melakukan clustering dengan pendekatan <em>de novo</em>.</p>
<pre><code>qiime vsearch cluster-features-de-novo \
--i-table table-dada2.qza \
--i-sequences rep-seqs-dada2.qza \
--p-perc-identity 0.97 \
--o-clustered-table merged-table-dada2-clustering.qza \
--o-clustered-sequences merged-rep-seqs-dada2-clustering.qza</code></pre>
<pre><code>qiime feature-table summarize \
--i-table merged-table-dada2-clustering.qza \
--o-visualization merged-table-dada2-clustering.qzv

qiime feature-table tabulate-seqs \
--i-data merged-rep-seqs-dada2-clustering.qza \
--o-visualization merged-rep-seqs-dada2-clustering.qzv</code></pre>
<p><strong>Catatan:</strong></p>
<ul>
<li>Selain pendekatan Clustering atau membuat OTU, saat ini juga ada pendekatan ASV (<em>Amplicon Sequence Variants</em>) (Callahan, McMurdie, &amp; Holmes, 2017). Pendekatan ini menasumsikan setiap sekuen unik sebagai satu ASV. Dengan demikin jumlah ASVs akan lebih banyak daripada jumlah OTUs pada data yang sama.</li>
<li>Secara teknis, jika ingin menggunakan pendekatan ASVs, kita dapat melewatkan proses clustering dan memakai data hasil dari DADA2 sebagai data ASVs.</li>
</ul>
</div>
<div id="taxonomy-assignment" class="section level3">
<h3>4. Taxonomy assignment</h3>
<p>Taxonomy assignment adalah sebuah cara untuk membandingkan data sekuen yang dimiliki dengan database sekuen yang tersedia untuk mendapatkan taxonomy yang mendekati.</p>
<p>Pada proses ini, diperlukan database yang telah dibuat khusus berdasarkan marker tertentu dan sudah melalui <em>peer review</em>. Beberapa contoh database dapat diunduh melalui: PR2 (<a href="https://pr2-database.org" class="uri">https://pr2-database.org</a>), SILVA (<a href="https://www.arb-silva.de/projects/eukaryotic-taxonomy" class="uri">https://www.arb-silva.de/projects/eukaryotic-taxonomy</a>), Midori (<a href="http://www.reference-midori.info/download.php" class="uri">http://www.reference-midori.info/download.php</a>, Wang et al., 2007)</p>
<p>Pada contoh ini, kita akan menggunakan database Midori (Leray, Ho, Lin, &amp; Machida, 2018) sebagai pembanding terhadap data COI metabarcoding kita.</p>
<pre><code>qiime feature-classifier classify-consensus-blast \
    --i-query merged-rep-seqs-dada2-clustering.qza \
    --i-reference-taxonomy MIDORI_LONGEST_20180221_COI_taxonomy.qza \
    --i-reference-reads MIDORI_LONGEST_20180221_COI.qza \
    --o-classification taxonomy.qza</code></pre>
<pre><code>qiime metadata tabulate \
  --m-input-file taxonomy.qza \
  --o-visualization taxonomy.qzv</code></pre>
</div>
<div id="phylogenetic-tree" class="section level3">
<h3>5. Phylogenetic tree</h3>
<pre><code>qiime phylogeny align-to-tree-mafft-fasttree \
  --i-sequences merged-rep-seqs-dada2-clustering.qza \
  --o-alignment aligned-rep-seqs.qza \
  --o-masked-alignment masked-aligned-rep-seqs.qza \
  --o-tree unrooted-tree.qza \
  --o-rooted-tree rooted-tree.qza</code></pre>
</div>
<div id="konversi-hasil" class="section level3">
<h3>6. Konversi hasil</h3>
<pre><code>qiime tools export \
--input-path merged-table-dada2-clustering.qza \
--output-path statistic

biom convert -i statistic/feature-table.biom -o statistic/otu_table.txt --to-tsv

qiime tools export \
--input-path unrooted-tree.qza \
--output-path statistic

qiime tools export \
--input-path taxonomy.qza \
--output-path statistic</code></pre>
<p>Hasilnya adalah:</p>
<ul>
<li>Folder statistic yang didalamnya terdiri dari file otu_table; tree.nwk; Taxonomy.tsv</li>
</ul>
</div>
<div id="barplot" class="section level3">
<h3>7. Barplot</h3>
<pre><code>qiime taxa barplot \
  --i-table merged-table-dada2-clustering.qza \
  --i-taxonomy taxonomy.qza \
  --m-metadata-file map_workshop.txt \
  --o-visualization taxa-bar-plots.qzv</code></pre>
<p>Hasil ini untuk melihat prosentasi taxonomic assigment dari 2 sampel ASEU1A100 dan ASEU1A500</p>
</div>
<div id="alpha-and-beta-diversity" class="section level3">
<h3>8. Alpha and beta diversity</h3>
<p>Pada proses ini kita akan menentukan <code>--p-sampling-depth</code>. Ini meupakan even sampling (i.e. rarefaction) depth. Nilai bisa kita lihat pada merged-table-dada2-clustering.qzv dan biasanya diambil nilai terendah dari reads/sekuen per sample.</p>
<p><strong>Catatan:</strong></p>
<ul>
<li>Data yang digunakan disini disiapkan dalam folder “Step_8”</li>
<li>Jadi kita akan kerja di dalam folder ini, mulai dengan cd xxx/Step_8</li>
<li>Dalam map.txt, “Fraction size” harus dalam bentuk numerik, jadi “1” menunjukkan ukuran 100 um pada sample, “2” menunjukkan ukuran “500 um, dan “3” menunjukkan sessile sample.</li>
<li>Kita akan buat sampling depth menjadi 33.000</li>
</ul>
<pre><code>qiime diversity core-metrics-phylogenetic \
  --i-phylogeny rooted-tree.qza \
  --i-table merged-table-dada2-clustering.qza \
  --p-sampling-depth 33000 \
  --m-metadata-file map_workshop.txt \
  --output-dir core-metrics-results

qiime emperor plot \
  --i-pcoa core-metrics-results/unweighted_unifrac_pcoa_results.qza \
  --m-metadata-file map_workshop.txt \
  --p-custom-axes Fraction_Size \
  --o-visualization core-metrics-results/unweighted-unifrac-emperor-days-since-experiment-start.qzv

qiime emperor plot \
  --i-pcoa core-metrics-results/bray_curtis_pcoa_results.qza \
  --m-metadata-file map_workshop.txt \
  --p-custom-axes Fraction_Size \
  --o-visualization core-metrics-results/bray-curtis-emperor-days-since-experiment-start.qzv</code></pre>
</div>
<div id="visualisasi" class="section level3">
<h3>9. Visualisasi</h3>
<p>Untuk dapat melihat hasil analisis, silakan masuk ke <a href="https://view.qiime2.org/" class="uri">https://view.qiime2.org/</a> dan masukkan file.qzv yang ingin di-visualisasi.</p>
</div>
<div id="qiime2-di-os-windows" class="section level3">
<h3>10. QIIME2 di OS windows</h3>
<ul>
<li>Pastikan windows terintall sebagai Windows Subsytem Linux (WSL) 1 atau 2 (pilih salah satu saja). Note : WSL 2 lebih ter-update. Link tutorial install WSL 2 : <a href="https://www.youtube.com/watch?v=_fntjriRe48" class="uri">https://www.youtube.com/watch?v=_fntjriRe48</a></li>
<li>Setelah itu buka CMD (run as administrator), download file conda melalui wget (ex: miniconda), link (<a href="https://docs.conda.io/en/latest/miniconda.html" class="uri">https://docs.conda.io/en/latest/miniconda.html</a>). Ketik kata seperti ini di CMD kita: wget <a href="https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh" class="uri">https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh</a></li>
<li>Setelah di download gunakan WSL di CMD kita dengan ketik “bash” dan install file .sh miniconda yg telah di download. Ketik pada CMD kita: bash Miniconda3-latest-Linux-x86_64.sh</li>
<li>Setelah terinstal silakan ketik “conda” pada CMD versi WSL kita apakah conda kita sudah terinstall. Jika sudah silakan install qiime2 melalui link <a href="https://docs.qiime2.org/2021.2/install/native/" class="uri">https://docs.qiime2.org/2021.2/install/native/</a></li>
</ul>
<p>Daftar Pustaka</p>
<p>Bolyen, E., Rideout, J. R., Dillon, M. R., Bokulich, N. A., Abnet, C., Ghalith, G. A. Al, … Naimey, A. T. (2018). QIIME 2 : Reproducible , interactive , scalable , and extensible microbiome data science. PeerJ. <a href="https://doi.org/10.7287/peerj.preprints.27295v2" class="uri">https://doi.org/10.7287/peerj.preprints.27295v2</a></p>
<p>Callahan, B. J., McMurdie, P. J., &amp; Holmes, S. P. (2017). Exact sequence variants should replace operational taxonomic units in marker-gene data analysis. ISME Journal. <a href="https://doi.org/10.1038/ismej.2017.119" class="uri">https://doi.org/10.1038/ismej.2017.119</a></p>
<p>Callahan, B. J., McMurdie, P. J., Rosen, M. J., Han, A. W., Johnson, A. J. A., &amp; Holmes, S. P. (2016). DADA2: High-resolution sample inference from Illumina amplicon data. Nature Methods, 13(7), 581–583. <a href="https://doi.org/10.1038/nmeth.3869" class="uri">https://doi.org/10.1038/nmeth.3869</a></p>
<p>Hebert, P. D. N., Ratnasingham, S., Waard, J. R. De, B, P. R. S. L., &amp; Jeremy, R. (2003). Barcoding animal life : cytochrome c oxidase subunit 1 divergences among closely related species Barcoding animal life : cytochrome c oxidase subunit 1 divergences among closely related species. <a href="https://doi.org/10.1098/rsbl.2003.0025" class="uri">https://doi.org/10.1098/rsbl.2003.0025</a></p>
<p>Leray, M., Ho, S. L., Lin, I. J., &amp; Machida, R. J. (2018). MIDORI server: a webserver for taxonomic assignment of unknown metazoan mitochondrial-encoded sequences using a curated database. Bioinformatics (Oxford, England). <a href="https://doi.org/10.1093/bioinformatics/bty454" class="uri">https://doi.org/10.1093/bioinformatics/bty454</a></p>
<p>Leray, M., Yang, J. Y., Meyer, C. P., Mills, S. C., Agudelo, N., Ranwez, V., … Machida, R. J. (2013). A new versatile primer set targeting a short fragment of the mitochondrial COI region for metabarcoding metazoan diversity: application for characterizing coral reef fish gut contents. Frontiers in Zoology, 10(1). <a href="https://doi.org/10.1186/1742-9994-10-34" class="uri">https://doi.org/10.1186/1742-9994-10-34</a></p>
<p>Martin, M. (2011). Cutadapt removes adapter sequences from high-throughput sequencing reads. EMBnet.Journal. <a href="https://doi.org/10.14806/ej.17.1.200" class="uri">https://doi.org/10.14806/ej.17.1.200</a></p>
<p>Murphy, K. and Macdonald, K. 2018. COI metabarcoding – Illumina DNA library preparation using two-step PCR. Laboratories of Analytical Biology. Smithsonian Institution National Museum of Natural History.</p>
<p>Rognes, T., Flouri, T., Nichols, B., Quince, C., &amp; Mahé, F. (2016). VSEARCH: a versatile open source tool for metagenomics. PeerJ, 4. <a href="https://doi.org/10.7717/peerj.2584" class="uri">https://doi.org/10.7717/peerj.2584</a></p>
</div>
</div>

<div class="footer">
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank"><i class="fa fa-creative-commons fa-2x"></i></a>&nbsp;
<a href="https://twitter.com/genetics_blog" target="_blank"><i class="fa fa-twitter fa-2x"></i></a>&nbsp;
<a href="https://github.com/4va/biodatasci" target="_blank"><i class="fa fa-github fa-2x"></i></a>&nbsp;
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
